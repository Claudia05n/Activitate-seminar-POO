#include<iostream>
#include<string>

using namespace std;

enum Stare { NOUA = 1, RULATA = 2, AVARIATA = 3 };

class Masina {
private:
	const int codSasiu;
	float pretAchizitie;
	string marcaModel;
	Stare stare;
	int nrRevizii;
	float* costuriRevizii;
	static int nrTotalMasini;

public:
	Masina() :codSasiu(++nrTotalMasini) {
		this->marcaModel = "Model Necunoscut";
		this->pretAchizitie = 0;
		this->nrRevizii = 0;
		this->costuriRevizii = nullptr;
		this->stare = RULATA;
	}

	Masina(string marcaModel, float pretAchizitie, int nrRevizii, float* costuriReviziiSursa, Stare stare) :codSasiu(++nrTotalMasini) {
		this->marcaModel = marcaModel;
		this->pretAchizitie = pretAchizitie;
		this->nrRevizii = nrRevizii;
		this->costuriRevizii = new float[this->nrRevizii];
		for (int i = 0; i < this->nrRevizii; i++) {
			this->costuriRevizii[i] = costuriReviziiSursa[i];
		}
		this->stare = stare;
		delete[] costuriReviziiSursa;
	}

	Masina(const Masina& copie) :codSasiu(++nrTotalMasini) {
		this->pretAchizitie = copie.pretAchizitie;
		this->marcaModel = copie.marcaModel;
		this->stare = copie.stare;
		this->nrRevizii = copie.nrRevizii;

		if (copie.costuriRevizii != nullptr) {
			this->costuriRevizii = new float[copie.nrRevizii];
			for (int i = 0; i < copie.nrRevizii; i++) {
				this->costuriRevizii[i] = copie.costuriRevizii[i];
			}
		}
		else {
			this->costuriRevizii = nullptr;
		}
	}
	
	void operator=(const Masina& copie) {

		this->marcaModel = copie.marcaModel;
		this->pretAchizitie = copie.pretAchizitie;
		this->stare = copie.stare;
		this->nrRevizii = copie.nrRevizii;

		if (this->costuriRevizii != nullptr) {
			delete[] this->costuriRevizii;
			this->costuriRevizii = nullptr;
		}

		if (copie.costuriRevizii != nullptr) {
			this->costuriRevizii = new float[copie.nrRevizii];
			for (int i = 0; i < copie.nrRevizii; i++) {
				this->costuriRevizii[i] = copie.costuriRevizii[i];
			}
		}
		else {
			this->costuriRevizii = nullptr;
		}
	}

	void operator+=(float valoareAdaugata) {
		this->pretAchizitie += valoareAdaugata;
	}

	bool operator>(const Masina& masina) {
		return this->pretAchizitie > masina.pretAchizitie;
	}

	void afisareMasina() {
		cout << endl << this->codSasiu << ". Masina modelul " << this->marcaModel
			<< " (Stare: ";
		if (this->stare == NOUA) cout << "NOUA";
		if (this->stare == RULATA) cout << "RULATA";
		if (this->stare == AVARIATA) cout << "AVARIATA";

		cout << ") achizitionata cu pretul de " << this->pretAchizitie
			<< " lei. A avut " << this->nrRevizii << " revizii cu costurile: ";

		if (this->costuriRevizii != nullptr) {
			for (int i = 0; i < this->nrRevizii - 1; i++) {
				cout << this->costuriRevizii[i] << " lei, ";
			}
			cout << this->costuriRevizii[this->nrRevizii - 1] << " lei.";
		}
	}

	int getNrRevizii() {
		return this->nrRevizii;
	}

	void setNrRevizii(int nrReviziiNou) {
		if (nrReviziiNou > 0)
		{
			this->nrRevizii = nrReviziiNou;
		}
		else {
			throw "Numar negativ";
		}
	}

	float* getCosturiRevizii() {
		float* copieCosturi = new float[this->nrRevizii];
		for (int i = 0; i < this->nrRevizii; i++) {
			copieCosturi[i] = this->costuriRevizii[i];
		}
		return copieCosturi;
	}

	void setCosturiRevizii(float* costuriNoi, int nrReviziiNou) {
		setNrRevizii(nrReviziiNou);

		if (this->costuriRevizii != nullptr) {
			delete[] this->costuriRevizii;
		}

		this->costuriRevizii = new float[this->nrRevizii];
		for (int i = 0; i < this->nrRevizii; i++) {
			this->costuriRevizii[i] = costuriNoi[i];
		}

		delete[] costuriNoi;
	}

	~Masina() {
		if (this->costuriRevizii != nullptr) {
			delete[] this->costuriRevizii;
		}
	}
};

int Masina::nrTotalMasini = 0;

void main() {
	float* costuri1 = new float[3] {500, 1500, 800};

	Masina dacia;
	Masina* bmw = new Masina("BMW M3", 50000, 3, costuri1, NOUA);

	Masina masinaCopie(*bmw);
	masinaCopie.afisareMasina(); 

	dacia = *bmw; 
	dacia.afisareMasina();

	dacia += 1000;
	dacia.afisareMasina(); 

	if (masinaCopie > dacia) {
		cout << endl << " Masina Copie este mai scumpa!";
	}
	else {
		cout << endl << " Masina Dacia (actualizata) este mai scumpa sau egala!";
	}

	delete bmw;
}
